{
  "hash": "0e994ddb2dd03400279f542a8e84de55",
  "result": {
    "markdown": "---\ntitle: \"Linear Discriminant Analysis\"\n---\n\n\n\n\n\n## Model Construction\n\n::: {.cell}\n\n```{.r .cell-code}\n#------------#\n#----QDA-----#\n#------------#\nset.seed(1234)\ntrain_control <- trainControl(method = \"cv\", number = 10)\n\nset.seed(1234)\nqda_model <- train(good ~ ., \n                   data = train, \n                   method = \"qda\", \n                   trControl = train_control)\n\nsave(qda_model, file = \"dataset\\\\qda.model_kfoldCV.Rdata\")\n\n#------------------#\n#----QDA (Mod)-----#\n#------------------#\n```\n:::\n\n\n## K-fold CV\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data Import\nload(\"dataset\\\\wine.data.Rdata\")\nload(\"dataset\\\\train.Rdata\")\nload(\"dataset\\\\test.Rdata\")\n\n# Model Import\nload(\"dataset\\\\model\\\\qda.model_kfoldCV.Rdata\")\n\nqda.predictions <- predict(qda_model, newdata = test)\n\nconfusionMatrix(qda.predictions, test$good)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction   0   1\n         0 704  59\n         1 245 180\n                                          \n               Accuracy : 0.7441          \n                 95% CI : (0.7183, 0.7687)\n    No Information Rate : 0.7988          \n    P-Value [Acc > NIR] : 1               \n                                          \n                  Kappa : 0.3834          \n                                          \n Mcnemar's Test P-Value : <2e-16          \n                                          \n            Sensitivity : 0.7418          \n            Specificity : 0.7531          \n         Pos Pred Value : 0.9227          \n         Neg Pred Value : 0.4235          \n             Prevalence : 0.7988          \n         Detection Rate : 0.5926          \n   Detection Prevalence : 0.6423          \n      Balanced Accuracy : 0.7475          \n                                          \n       'Positive' Class : 0               \n                                          \n```\n:::\n\n```{.r .cell-code}\nqda.predictions <- as.numeric(qda.predictions)\npred_obj <- prediction(qda.predictions, test$good)\nauc_val <- performance(pred_obj, \"auc\")@y.values[[1]]\nauc_val\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7474858\n```\n:::\n\n```{.r .cell-code}\nroc_obj <- performance(pred_obj, \"tpr\", \"fpr\")\nplot(roc_obj, colorize = TRUE, lwd = 2,\n     xlab = \"False Positive Rate\", \n     ylab = \"True Positive Rate\",\n     main = \"ROC Curves from Repeated CV\")\npoints(auc_val, 1 - auc_val, \n       col = \"steelblue\", \n       pch = 21)\nabline(a = 0, b = 1)\n```\n\n```{.r .cell-code}\nqda.kfoldCV.ROC.plot <- recordPlot()\n```\n:::\n\n\n### Tuned\n\n::: {.cell}\n\n:::\n\n\n| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |\n| ----------------- | ---------- | ----------- | ----------- | --------- |\n| QDA               | 0.2559     | 0.7418      | 0.7531      | 0.7474858 |\n| QDA (Tuned)       | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |\n\n\n## Summary\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncowplot::plot_grid(knn.kfoldCV.ROC.plot,\n                   logit.kfoldCV.ROC.plot,\n                   lda.kfoldCV.ROC.plot,\n                   qda.kfoldCV.ROC.plot, \n                   ncol = 2, align = \"hv\", scale = 0.8)\n```\n\n::: {.cell-output-display}\n![](qda_files/figure-html/log.lda.qda.ROC_curve-1.png){width=960}\n:::\n:::\n\n\n\n| Resampling Method           | Error Rate | Sensitivity | Specificity | AUC       |\n| --------------------------- | ---------- | ----------- | ----------- | --------- |\n| Logistic Regression         | 0.1944     | 0.9347      | 0.2929      | 0.6137776 |\n| Logistic Regression (Tuned) | 0.1919     | 0.98946     | 0.08787     | 0.5386644 |\n|                             |            |             |             |           |\n| LDA                         | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |\n| LDA (Tuned)                 | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |\n|                             |            |             |             |           |\n| QDA                         | 0.2559     | 0.7418      | 0.7531      | 0.7474858 |\n| QDA (Tuned)                 | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "qda_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}